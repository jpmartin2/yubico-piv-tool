macro (find_openssl)
    if(NOT OPENSSL_FOUND)
        pkg_check_modules(OPENSSL REQUIRED libcrypto)
        if(OPENSSL_FOUND)
            if(VERBOSE_CMAKE)
                if (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
                    set(OPENSSL_CFLAGS "-I/usr/local/Cellar/openssl@1.1/1.1.1d")
                endif ()
                message("OPENSSL_FOUND: ${OPENSSL_FOUND}")
                message("OPENSSL_LIBRARIES: ${OPENSSL_LIBRARIES}")
                message("OPENSSL_LIBRARY_DIRS: ${OPENSSL_LIBRARY_DIRS}")
                message("OPENSSL_LDFLAGS: ${OPENSSL_LDFLAGS}")
                message("OPENSSL_LDFLAGS_OTHER: ${OPENSSL_LDFLAGS_OTHER}")
                message("OPENSSL_INCLUDE_DIRS: ${OPENSSL_INCLUDE_DIRS}")
                message("OPENSSL_CFLAGS: ${OPENSSL_CFLAGS}")
                message("OPENSSL_CFLAGS_OTHER: ${OPENSSL_CFLAGS_OTHER}")
                message("OPENSSL_VERSION: ${OPENSSL_VERSION}")
                message("OPENSSL_INCLUDEDIR: ${OPENSSL_INCLUDEDIR}")
                message("OPENSSL_LIBDIR: ${OPENSSL_LIBDIR}")
            endif(VERBOSE_CMAKE)
            set(LIBCRYPTO_VERSION ${OPENSSL_VERSION})
        else(OPENSSL_FOUND)
            message (FATAL_ERROR "libcrypto not found. Aborting...")
        endif(OPENSSL_FOUND)
    endif(NOT OPENSSL_FOUND)

endmacro()